From d062213b79068400df732f89ca9de5662bc347f4 Mon Sep 17 00:00:00 2001
From: Eli Collins <eli@cloudera.com>
Date: Sun, 11 Mar 2012 12:16:53 -0700
Subject: [PATCH 0001/1357] CLOUDERA-BUILD. Updating for 4.0.0 development.

---
 hadoop-assemblies/pom.xml                          |    4 +-
 hadoop-client/pom.xml                              |    4 +-
 hadoop-common-project/hadoop-annotations/pom.xml   |    4 +-
 hadoop-common-project/hadoop-auth-examples/pom.xml |    4 +-
 hadoop-common-project/hadoop-auth/pom.xml          |    4 +-
 hadoop-common-project/hadoop-common/pom.xml        |    6 +-
 hadoop-common-project/pom.xml                      |    4 +-
 hadoop-dist/pom.xml                                |    4 +-
 hadoop-hdfs-project/hadoop-hdfs-httpfs/pom.xml     |    4 +-
 hadoop-hdfs-project/hadoop-hdfs/pom.xml            |    4 +-
 .../hadoop-hdfs/src/contrib/fuse-dfs/pom.xml       |    4 +-
 .../java/org/apache/hadoop/hdfs/DFSConfigKeys.java |    4 +-
 .../hadoop-hdfs/src/test/aop/build/aop.xml         |  121 ++++++++++++--------
 hadoop-hdfs-project/pom.xml                        |    5 +-
 hadoop-mapreduce-project/build.xml                 |    2 +-
 .../hadoop-mapreduce-client-app/pom.xml            |    6 +-
 .../hadoop-mapreduce-client-common/pom.xml         |    4 +-
 .../hadoop-mapreduce-client-core/pom.xml           |    4 +-
 .../hadoop-mapreduce-client-hs/pom.xml             |    4 +-
 .../hadoop-mapreduce-client-jobclient/pom.xml      |    4 +-
 .../hadoop-mapreduce-client-shuffle/pom.xml        |    4 +-
 .../hadoop-mapreduce-client/pom.xml                |    4 +-
 .../hadoop-mapreduce-examples/pom.xml              |    4 +-
 .../hadoop-yarn/hadoop-yarn-api/pom.xml            |    4 +-
 .../pom.xml                                        |    4 +-
 .../hadoop-yarn/hadoop-yarn-applications/pom.xml   |    4 +-
 .../hadoop-yarn/hadoop-yarn-common/pom.xml         |    4 +-
 .../hadoop-yarn-server-common/pom.xml              |    4 +-
 .../hadoop-yarn-server-nodemanager/pom.xml         |    4 +-
 .../hadoop-yarn-server-resourcemanager/pom.xml     |    4 +-
 .../hadoop-yarn-server-tests/pom.xml               |    4 +-
 .../hadoop-yarn-server-web-proxy/pom.xml           |    2 +-
 .../hadoop-yarn/hadoop-yarn-server/pom.xml         |    4 +-
 .../hadoop-yarn/hadoop-yarn-site/pom.xml           |    4 +-
 hadoop-mapreduce-project/hadoop-yarn/pom.xml       |    4 +-
 .../ivy/hadoop-mapred-instrumented-template.xml    |    2 +-
 .../ivy/hadoop-mapred-template.xml                 |    2 +-
 hadoop-mapreduce-project/ivy/libraries.properties  |    8 +-
 hadoop-mapreduce-project/pom.xml                   |    4 +-
 .../src/test/aop/build/aop.xml                     |    2 +-
 hadoop-minicluster/pom.xml                         |    4 +-
 hadoop-project-dist/pom.xml                        |    4 +-
 hadoop-project/pom.xml                             |   13 ++-
 hadoop-tools/hadoop-archives/pom.xml               |    4 +-
 hadoop-tools/hadoop-distcp/pom.xml                 |    4 +-
 hadoop-tools/hadoop-extras/pom.xml                 |    4 +-
 hadoop-tools/hadoop-rumen/pom.xml                  |   14 +--
 hadoop-tools/hadoop-streaming/pom.xml              |   14 +--
 hadoop-tools/hadoop-tools-dist/pom.xml             |    4 +-
 hadoop-tools/pom.xml                               |    4 +-
 pom.xml                                            |   37 ++++--
 51 files changed, 201 insertions(+), 181 deletions(-)

diff --git a/hadoop-assemblies/pom.xml b/hadoop-assemblies/pom.xml
index 39ca65b..dbc597a 100644
--- a/hadoop-assemblies/pom.xml
+++ b/hadoop-assemblies/pom.xml
@@ -20,12 +20,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-assemblies</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>Apache Hadoop Assemblies</name>
   <description>Apache Hadoop Assemblies</description>
 
diff --git a/hadoop-client/pom.xml b/hadoop-client/pom.xml
index afb944e..c98a127 100644
--- a/hadoop-client/pom.xml
+++ b/hadoop-client/pom.xml
@@ -18,12 +18,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project-dist</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project-dist</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-client</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>jar</packaging>
 
   <description>Apache Hadoop Client</description>
diff --git a/hadoop-common-project/hadoop-annotations/pom.xml b/hadoop-common-project/hadoop-annotations/pom.xml
index 0e446a8..55f510d 100644
--- a/hadoop-common-project/hadoop-annotations/pom.xml
+++ b/hadoop-common-project/hadoop-annotations/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-annotations</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Annotations</description>
   <name>Apache Hadoop Annotations</name>
   <packaging>jar</packaging>
diff --git a/hadoop-common-project/hadoop-auth-examples/pom.xml b/hadoop-common-project/hadoop-auth-examples/pom.xml
index f812c66..89fd9e5 100644
--- a/hadoop-common-project/hadoop-auth-examples/pom.xml
+++ b/hadoop-common-project/hadoop-auth-examples/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-auth-examples</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>war</packaging>
 
   <name>Apache Hadoop Auth Examples</name>
diff --git a/hadoop-common-project/hadoop-auth/pom.xml b/hadoop-common-project/hadoop-auth/pom.xml
index aa2617f..f3c858e 100644
--- a/hadoop-common-project/hadoop-auth/pom.xml
+++ b/hadoop-common-project/hadoop-auth/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-auth</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>jar</packaging>
 
   <name>Apache Hadoop Auth</name>
diff --git a/hadoop-common-project/hadoop-common/pom.xml b/hadoop-common-project/hadoop-common/pom.xml
index 94ee24d..66f11bd 100644
--- a/hadoop-common-project/hadoop-common/pom.xml
+++ b/hadoop-common-project/hadoop-common/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project-dist</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project-dist</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-common</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Common</description>
   <name>Apache Hadoop Common</name>
   <packaging>jar</packaging>
@@ -272,7 +272,6 @@
     <dependency>
       <groupId>org.apache.zookeeper</groupId>
       <artifactId>zookeeper</artifactId>
-      <version>3.4.2</version>
       <exclusions>
         <exclusion>
           <!-- otherwise seems to drag in junit 3.8.1 via jline -->
@@ -292,7 +291,6 @@
     <dependency>
       <groupId>org.apache.zookeeper</groupId>
       <artifactId>zookeeper</artifactId>
-      <version>3.4.2</version>
       <type>test-jar</type>
       <scope>test</scope>
     </dependency>
diff --git a/hadoop-common-project/pom.xml b/hadoop-common-project/pom.xml
index b1f7000..93ad637 100644
--- a/hadoop-common-project/pom.xml
+++ b/hadoop-common-project/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-common-project</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Common Project</description>
   <name>Apache Hadoop Common Project</name>
   <packaging>pom</packaging>
diff --git a/hadoop-dist/pom.xml b/hadoop-dist/pom.xml
index 1a2631c..75bd429 100644
--- a/hadoop-dist/pom.xml
+++ b/hadoop-dist/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-dist</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Distribution</description>
   <name>Apache Hadoop Distribution</name>
   <packaging>jar</packaging>
diff --git a/hadoop-hdfs-project/hadoop-hdfs-httpfs/pom.xml b/hadoop-hdfs-project/hadoop-hdfs-httpfs/pom.xml
index ec88aba..79c0b7f 100644
--- a/hadoop-hdfs-project/hadoop-hdfs-httpfs/pom.xml
+++ b/hadoop-hdfs-project/hadoop-hdfs-httpfs/pom.xml
@@ -19,12 +19,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-hdfs-httpfs</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>war</packaging>
 
   <name>Apache Hadoop HttpFS</name>
diff --git a/hadoop-hdfs-project/hadoop-hdfs/pom.xml b/hadoop-hdfs-project/hadoop-hdfs/pom.xml
index d77e254..3568a9f 100644
--- a/hadoop-hdfs-project/hadoop-hdfs/pom.xml
+++ b/hadoop-hdfs-project/hadoop-hdfs/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project-dist</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project-dist</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-hdfs</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop HDFS</description>
   <name>Apache Hadoop HDFS</name>
   <packaging>jar</packaging>
diff --git a/hadoop-hdfs-project/hadoop-hdfs/src/contrib/fuse-dfs/pom.xml b/hadoop-hdfs-project/hadoop-hdfs/src/contrib/fuse-dfs/pom.xml
index 1782e9f..63e485e 100644
--- a/hadoop-hdfs-project/hadoop-hdfs/src/contrib/fuse-dfs/pom.xml
+++ b/hadoop-hdfs-project/hadoop-hdfs/src/contrib/fuse-dfs/pom.xml
@@ -19,12 +19,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../../../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop.contrib</groupId>
   <artifactId>hadoop-hdfs-fuse</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>pom</packaging>
 
   <name>Apache Hadoop HDFS Fuse</name>
diff --git a/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java b/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java
index e92d34d..22d47e1 100644
--- a/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java
+++ b/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java
@@ -145,7 +145,7 @@ public class DFSConfigKeys extends CommonConfigurationKeys {
   public static final String  DFS_NAMENODE_NUM_EXTRA_EDITS_RETAINED_KEY = "dfs.namenode.num.extra.edits.retained";
   public static final int     DFS_NAMENODE_NUM_EXTRA_EDITS_RETAINED_DEFAULT = 1000000; //1M
   public static final String  DFS_NAMENODE_MIN_SUPPORTED_DATANODE_VERSION_KEY = "dfs.namenode.min.supported.datanode.version";
-  public static final String  DFS_NAMENODE_MIN_SUPPORTED_DATANODE_VERSION_DEFAULT = "2.0.0";
+  public static final String  DFS_NAMENODE_MIN_SUPPORTED_DATANODE_VERSION_DEFAULT = "2.0.0-cdh4.0.0-SNAPSHOT";
 
   public static final String  DFS_NAMENODE_EDITS_DIR_MINIMUM_KEY = "dfs.namenode.edits.dir.minimum";
   public static final int     DFS_NAMENODE_EDITS_DIR_MINIMUM_DEFAULT = 1;
@@ -263,7 +263,7 @@ public class DFSConfigKeys extends CommonConfigurationKeys {
   public static final int     DFS_DATANODE_IPC_DEFAULT_PORT = 50020;
   public static final String  DFS_DATANODE_IPC_ADDRESS_DEFAULT = "0.0.0.0" + DFS_DATANODE_IPC_DEFAULT_PORT;
   public static final String  DFS_DATANODE_MIN_SUPPORTED_NAMENODE_VERSION_KEY = "dfs.datanode.min.supported.namenode.version";
-  public static final String  DFS_DATANODE_MIN_SUPPORTED_NAMENODE_VERSION_DEFAULT = "2.0.0";
+  public static final String  DFS_DATANODE_MIN_SUPPORTED_NAMENODE_VERSION_DEFAULT = "2.0.0-cdh4.0.0-SNAPSHOT";
 
   public static final String  DFS_BLOCK_ACCESS_TOKEN_ENABLE_KEY = "dfs.block.access.token.enable";
   public static final boolean DFS_BLOCK_ACCESS_TOKEN_ENABLE_DEFAULT = false;
diff --git a/hadoop-hdfs-project/hadoop-hdfs/src/test/aop/build/aop.xml b/hadoop-hdfs-project/hadoop-hdfs/src/test/aop/build/aop.xml
index 1b6a7dd..168342c 100644
--- a/hadoop-hdfs-project/hadoop-hdfs/src/test/aop/build/aop.xml
+++ b/hadoop-hdfs-project/hadoop-hdfs/src/test/aop/build/aop.xml
@@ -21,7 +21,7 @@
   <property name="aspectversion" value="1.6.5"/>
   <!-- TODO this has to be changed synchronously with build.xml version prop.-->
   <!-- this workarounds of test-patch setting its own 'version' -->
-  <property name="project.version" value="2.0.0-alpha"/>
+  <property name="project.version" value="2.0.0-cdh4.0.0-SNAPSHOT"/>
 
   <!-- Properties common for all fault injections -->
   <property name="build-fi.dir" value="${basedir}/build-fi"/>
@@ -30,25 +30,25 @@
   <property file="${basedir}/build.properties"/>
 
   <!-- Properties related to system fault injection and tests -->
+  <property name="herriot.suffix" value="instrumented"/>
   <property name="system-test-build-dir" value="${build-fi.dir}/system"/>
   <!-- This varialbe is set by respective injection targets -->
-  <property name="hadoop.instrumented.jar" value=""/>
-
+  <property name="hadoop.instrumented.jars" value=""/>
   <!-- Properties specifically for system fault-injections and system tests -->
   <property name="herriot.suffix" value="instrumented"/>
   <property name="instrumented.final.name"
             value="${name}-${herriot.suffix}-${version}"/>
-  <property name="hadoop-hdfs-instrumented.pom"
-            location="${ivy.dir}/hadoop-hdfs-${herriot.suffix}.xml" />
-  <property name="hadoop-hdfs-instrumented-test.pom"
-            location="${ivy.dir}/hadoop-hdfs-${herriot.suffix}-test.xml" />
-  <property name="hadoop-hdfs-instrumented.jar"
+  <property name="hadoop-mapred-instrumented.pom"
+            location="${ivy.dir}/hadoop-mapred-${herriot.suffix}.xml" />
+  <property name="hadoop-mapred-instrumented-test.pom"
+            location="${ivy.dir}/hadoop-mapred-${herriot.suffix}-test.xml" />
+  <property name="hadoop-mapred-instrumented.jar"
             location="${system-test-build-dir}/${name}-${herriot.suffix}-${version}.jar" />
-  <property name="hadoop-hdfs-instrumented-sources.jar"
+  <property name="hadoop-mapred-instrumented-sources.jar"
             location="${system-test-build-dir}/${name}-${herriot.suffix}-${version}-sources.jar" />
-  <property name="hadoop-hdfs-instrumented-test.jar"
+  <property name="hadoop-mapred-instrumented-test.jar"
             location="${system-test-build-dir}/${name}-${herriot.suffix}-test-${version}.jar" />
-  <property name="hadoop-hdfs-instrumented-test-sources.jar"
+  <property name="hadoop-mapred-instrumented-test-sources.jar"
             location="${system-test-build-dir}/${name}-${herriot.suffix}-test-${version}-sources.jar" />
   <!--All Fault Injection (FI) related targets are located in this session -->
     
@@ -74,13 +74,13 @@
     </taskdef>
     <echo message="Start weaving aspects in place"/>
     <path id="aspect.path">
-      <pathelement location="${hadoop.instrumented.jar}"/>
+      <pathelement location="${hadoop.instrumented.jars}"/>
     </path>
     <iajc
       encoding="${build.encoding}" 
       srcdir="${java.src.dir};${build.src};${src.dir.path}"
       includes="org/apache/hadoop/**/*.java, org/apache/hadoop/**/*.aj"
-      excludes="org/apache/hadoop/classification/tools/**/*, org/apache/hadoop/record/**/*"
+      excludes="org/apache/hadoop/record/**/*"
       destDir="${dest.dir}"
       debug="${javac.debug}"
       target="${javac.version}"
@@ -110,9 +110,10 @@
         <pathelement location="${system-test-build-dir}/test/extraconf" />
         <pathelement location="${system-test-build-dir}/test/classes" />
         <pathelement location="${system-test-build-dir}/classes" />
+        <pathelement location="${system-test-build-dir}/test/mapred/classes"/>
+        <pathelement location="${system-test-build-dir}/tools" />
+        <pathelement location="${system-test-build-dir}" />
         <pathelement location="${test.src.dir}" />
-        <pathelement location="${build-fi.dir}" />
-        <pathelement location="${build-fi.dir}/tools" />
         <pathelement path="${clover.jar}" />
         <fileset dir="${system-test-build-dir}">
            <include name="**/*.jar" />
@@ -120,14 +121,33 @@
          </fileset>
         <path refid="classpath" />
   </path>
+  <!-- compile system tests... -->
+  <path id="test.system.compile.classpath">
+        <pathelement location="${system-test-build-dir}/test/extraconf" />
+        <pathelement location="${system-test-build-dir}/test/classes" />
+        <pathelement location="${system-test-build-dir}/classes" />
+        <pathelement location="${system-test-build-dir}/test/mapred/classes" />
+        <pathelement location="${system-test-build-dir}/test/mapred/testjar" />
+        <pathelement location="${system-test-build-dir}/tools" />
+        <pathelement location="${system-test-build-dir}/examples" />
+        <path refid="ivy-system.classpath"/>
+  </path>
 
   <!-- ================ -->
   <!-- run system tests -->
   <!-- ================ -->
-  <target name="test-system" depends="init, ivy-retrieve-system"
+  <target name="test-system" depends="ivy-retrieve-common, ivy-retrieve-system"
     description="Run system tests">
     <subant buildpath="build.xml" target="jar-test-system"/>
-    <macro-test-runner test.file="${test.hdfs.all.tests.file}"
+    <subant target="test-system-contrib">
+        <property name="hadoop.home" value="${hadoop.home}"/>
+       <property name="hadoop.conf.dir" value="${hadoop.conf.dir}"/>
+       <property name="version" value="${version}"/>
+       <property name="hadoop.conf.dir.deployed" 
+            value="${hadoop.conf.dir.deployed}"/>
+       <fileset file="${contrib.dir}/build.xml"/>
+    </subant>
+    <macro-test-runner test.file="${test.mapred.all.tests.file}"
                        suite.type="system/test"
                        classpath="test.system.classpath"
                        test.dir="${system-test-build-dir}/test"
@@ -143,7 +163,7 @@
     <delete file="${compile-inject.output}"/>
     <weave-injectfault-aspects dest.dir="${build-fi.dir}/classes"
                                src.dir="${test.src.dir}/aop"
-      aspects.jar="${build-fi.dir}/ivy/lib/${ant.project.name}/common/hadoop-common-${project.version}.jar">
+      aspects.jars="${build-fi.dir}/ivy/lib/${ant.project.name}/test/hadoop-common-${project.version}.jar">
     </weave-injectfault-aspects>
   </target>
 
@@ -153,7 +173,7 @@
   <!-- =============================================================== -->
   <target name="jar-system"
           depends="inject-system-faults"
-          description="Make hadoop-hdfs-instrumented.jar with system injections.">
+          description="Make hadoop-mapred-instrumented.jar with system injections.">
     <macro-jar-fault-inject target.name="jar"
       build.dir="${system-test-build-dir}"
       jar.final.name="final.name"
@@ -167,14 +187,15 @@
   </target>
 
   <target name="jar-test-system" depends="inject-system-faults, compile-test-system"
-    description="Make hadoop-hdfs-instrumented-test.jar with system injections.">
+    description="Make hadoop-mapred-instrumented-test.jar with system injections.">
     <subant buildpath="build.xml" target="-do-jar-test">
       <property name="build.dir" value="${system-test-build-dir}"/>
-      <property name="test.hdfs.final.name" value="${name}-${herriot.suffix}-test-${version}"/>
-      <property name="test.hdfs.build.classes"
+      <property name="test.final.name"
+        value="${name}-${herriot.suffix}-test-${project.version}"/>
+      <property name="test.build.classes"
         value="${system-test-build-dir}/test/classes"/>
     </subant>
-    <jar jarfile="${hadoop-hdfs-instrumented-test-sources.jar}">
+    <jar jarfile="${hadoop-mapred-instrumented-test-sources.jar}">
       <fileset dir="${test.src.dir}/system/test" includes="org/apache/hadoop/**/*.java" />
     </jar>
   </target>
@@ -185,18 +206,17 @@
     </subant>
   </target>
 
-  <target name="-compile-test-system.wrapper" depends="inject-system-faults, ivy-retrieve-common, ivy-retrieve-hdfs, ivy-retrieve-system">
-    <macro-compile-hdfs-test
-      target.dir="${system-test-build-dir}/test/classes"
+  <target name="-compile-test-system.wrapper" depends="inject-system-faults, ivy-retrieve-common, ivy-retrieve-system">
+    <macro-compile-test
       source.dir="${test.src.dir}/system/test"
       dest.dir="${system-test-build-dir}/test/classes"
-      classpath="test.system.classpath"/>
+      classpath="test.system.compile.classpath"/>
   </target>
 
   <macrodef name="weave-injectfault-aspects">
     <attribute name="dest.dir" />
     <attribute name="src.dir" />
-    <attribute name="aspects.jar"/>
+    <attribute name="aspects.jars"/>
     <attribute name="base.build.dir" default="${build-fi.dir}"/>
     <sequential>
       <subant buildpath="build.xml" target="-compile-fault-inject"
@@ -204,7 +224,7 @@
         <property name="build.dir" value="@{base.build.dir}" />
         <property name="src.dir.path" value="@{src.dir}" />
         <property name="dest.dir" value="@{dest.dir}" />
-        <property name="hadoop.instrumented.jar" value="@{aspects.jar}"/>
+        <property name="hadoop.instrumented.jars" value="@{aspects.jars}"/>
       </subant>
     </sequential>
   </macrodef>
@@ -218,7 +238,7 @@
     </subant>
     <weave-injectfault-aspects dest.dir="${system-test-build-dir}/classes"
                                src.dir="${test.src.dir}/system/java;${test.src.dir}/system/aop"
-      aspects.jar="${system-test-build-dir}/ivy/lib/${ant.project.name}/system/hadoop-common-${herriot.suffix}-${project.version}.jar"
+      aspects.jars="${system-test-build-dir}/ivy/lib/${ant.project.name}/system/hadoop-common-${herriot.suffix}-${project.version}.jar"
       base.build.dir="${system-test-build-dir}">
     </weave-injectfault-aspects>
   </target>
@@ -314,35 +334,36 @@
   <!-- End of cluster controller binary target -->
   <!-- Install Herriot artifacts to the local Maven -->
   <target name="-mvn-system-install" depends="mvn-taskdef, jar-system, jar-test-system">
-    <artifact:pom file="${hadoop-hdfs-instrumented.pom}"
-                  id="hadoop.hdfs.${herriot.suffix}"/>
-    <artifact:pom file="${hadoop-hdfs-instrumented-test.pom}"
-                  id="hadoop.hdfs.${herriot.suffix}.test"/>
-    <artifact:install file="${hadoop-hdfs-instrumented.jar}">
-      <pom refid="hadoop.hdfs.${herriot.suffix}"/>
-      <attach file="${hadoop-hdfs-instrumented-sources.jar}" classifier="sources" />
+    <artifact:pom file="${hadoop-mapred-instrumented.pom}"
+                  id="hadoop.mapred.${herriot.suffix}"/>
+    <artifact:pom file="${hadoop-mapred-instrumented-test.pom}"
+                  id="hadoop.mapred.${herriot.suffix}.test"/>
+    <artifact:install file="${hadoop-mapred-instrumented.jar}">
+      <pom refid="hadoop.mapred.${herriot.suffix}"/>
+      <attach file="${hadoop-mapred-instrumented-sources.jar}" classifier="sources" />
     </artifact:install>
-    <artifact:install file="${hadoop-hdfs-instrumented-test.jar}">
-      <pom refid="hadoop.hdfs.${herriot.suffix}.test"/>
-      <attach file="${hadoop-hdfs-instrumented-test-sources.jar}" classifier="sources" />
+    <artifact:install file="${hadoop-mapred-instrumented-test.jar}">
+      <pom refid="hadoop.mapred.${herriot.suffix}.test"/>
+      <attach file="${hadoop-mapred-instrumented-test-sources.jar}" classifier="sources" />
     </artifact:install>
   </target>
   <target name="-mvn-system-deploy" depends="mvn-taskdef, jar-system, jar-test-system">
     <property name="repourl" value="https://repository.apache.org/content/repositories/snapshots" />
-    <artifact:pom file="${hadoop-hdfs-instrumented.pom}"
-                  id="hadoop.hdfs.${herriot.suffix}"/>
-    <artifact:pom file="${hadoop-hdfs-instrumented-test.pom}"
-                   id="hadoop.hdfs.${herriot.suffix}.test"/>
+    <artifact:pom file="${hadoop-mapred-instrumented.pom}"
+                   id="hadoop.mapred.${herriot.suffix}"/>
+    <artifact:pom file="${hadoop-mapred-instrumented-test.pom}"
+                   id="hadoop.mapred.${herriot.suffix}.test"/>
+
     <artifact:install-provider artifactId="wagon-http" version="1.0-beta-2"/>
-    <artifact:deploy file="${hadoop-hdfs-instrumented.jar}">
+    <artifact:deploy file="${hadoop-mapred-instrumented.jar}">
       <remoteRepository id="apache.snapshots.https" url="${repourl}"/>
-      <pom refid="hadoop.hdfs.${herriot.suffix}"/>
-      <attach file="${hadoop-hdfs-instrumented-sources.jar}" classifier="sources" />
+      <pom refid="hadoop.mapred.${herriot.suffix}"/>
+      <attach file="${hadoop-mapred-instrumented-sources.jar}" classifier="sources" />
     </artifact:deploy>
-    <artifact:deploy file="${hadoop-hdfs-instrumented-test.jar}">
+    <artifact:deploy file="${hadoop-mapred-instrumented-test.jar}">
       <remoteRepository id="apache.snapshots.https" url="${repourl}"/>
-      <pom refid="hadoop.hdfs.${herriot.suffix}.test"/>
-      <attach file="${hadoop-hdfs-instrumented-test-sources.jar}" classifier="sources" />
+      <pom refid="hadoop.mapred.${herriot.suffix}.test"/>
+      <attach file="${hadoop-mapred-instrumented-test-sources.jar}" classifier="sources" />
     </artifact:deploy>
   </target>
   <!-- End of Maven -->
diff --git a/hadoop-hdfs-project/pom.xml b/hadoop-hdfs-project/pom.xml
index d74e4d7..08f2be1 100644
--- a/hadoop-hdfs-project/pom.xml
+++ b/hadoop-hdfs-project/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-hdfs-project</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop HDFS Project</description>
   <name>Apache Hadoop HDFS Project</name>
   <packaging>pom</packaging>
@@ -31,7 +31,6 @@
     <module>hadoop-hdfs</module>
     <module>hadoop-hdfs-httpfs</module>
     <module>hadoop-hdfs/src/contrib/fuse-dfs</module>
-    <module>hadoop-hdfs/src/contrib/bkjournal</module>
   </modules>
 
   <build>
diff --git a/hadoop-mapreduce-project/build.xml b/hadoop-mapreduce-project/build.xml
index 7a4b685..9f3f545 100644
--- a/hadoop-mapreduce-project/build.xml
+++ b/hadoop-mapreduce-project/build.xml
@@ -33,7 +33,7 @@
   <property name="name" value="hadoop-${module}"/>
   <!-- Need to change aop.xml project.version prop. synchronously -->
   <property name="_version" value="2.0.0"/>
-  <property name="version" value="${_version}"/>
+  <property name="version" value="${_version}-SNAPSHOT"/>
   <property name="final.name" value="${name}-${version}"/>
   <property name="test.final.name" value="${name}-test-${version}"/>
   <property name="examples.final.name" value="${name}-examples-${version}"/>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/pom.xml
index 2dc5b9b..f061ea3 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-mapreduce-client</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client-app</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client-app</name>
 
   <properties>
@@ -102,7 +102,7 @@
               <target>
                 <symlink link="${applink.base}.jar"
                     resource="mr-app.jar" failonerror="false"/>
-                <symlink link="${applink.base}-2.0.0-alpha.jar"
+                <symlink link="${applink.base}-2.0.0-cdh4.0.0-SNAPSHOT.jar"
                     resource="mr-app.jar" failonerror="false"/>
               </target>
             </configuration>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/pom.xml
index 1086bea..7abacd9 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-mapreduce-client</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client-common</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client-common</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/pom.xml
index fa667e0..3d4c596 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-mapreduce-client</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client-core</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client-core</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/pom.xml
index e891e44..2706dbc 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-mapreduce-client</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client-hs</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client-hs</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/pom.xml
index 9275c12..698655e 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-mapreduce-client</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client-jobclient</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client-jobclient</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-shuffle/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-shuffle/pom.xml
index 47f8d70..1132725 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-shuffle/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-shuffle/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-mapreduce-client</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client-shuffle</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client-shuffle</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-client/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-client/pom.xml
index 0415cd4..7ab1506 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-client/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-client/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-client</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-mapreduce-client</name>
   <packaging>pom</packaging>
 
diff --git a/hadoop-mapreduce-project/hadoop-mapreduce-examples/pom.xml b/hadoop-mapreduce-project/hadoop-mapreduce-examples/pom.xml
index 2b500b7..e3d5b59 100644
--- a/hadoop-mapreduce-project/hadoop-mapreduce-examples/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-mapreduce-examples/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce-examples</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop MapReduce Examples</description>
   <name>Apache Hadoop MapReduce Examples</name>
   <packaging>jar</packaging>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-api/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-api/pom.xml
index 497a95b..db6b659 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-api/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-api/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-api</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-api</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/pom.xml
index efaf49c..a483e80 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn-applications</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-applications-distributedshell</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-applications-distributedshell</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/pom.xml
index fba35c3..e882407 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-applications/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-applications</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-applications</name>
   <packaging>pom</packaging>
 
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-common/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-common/pom.xml
index ffedf79..9a12208 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-common/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-common/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-common</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-common</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common/pom.xml
index 30b8592..9a82797 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn-server</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-server-common</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-server-common</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/pom.xml
index 1d10f27..be0a736 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn-server</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-server-nodemanager</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-server-nodemanager</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/pom.xml
index 113fdd0..2b0d69b 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn-server</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-server-resourcemanager</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-server-resourcemanager</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-tests/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-tests/pom.xml
index d668965..d3f11ac 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-tests/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-tests/pom.xml
@@ -16,11 +16,11 @@
   <parent>
     <artifactId>hadoop-yarn-server</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-server-tests</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-server-tests</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-web-proxy/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-web-proxy/pom.xml
index 67739b8..f0e8c35 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-web-proxy/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-web-proxy/pom.xml
@@ -16,7 +16,7 @@
   <parent>
     <artifactId>hadoop-yarn-server</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/pom.xml
index efd6644..ce1920c 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-server/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-server</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-server</name>
   <packaging>pom</packaging>
 
diff --git a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-site/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-site/pom.xml
index db49e35..973a3e7 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-site/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/hadoop-yarn-site/pom.xml
@@ -16,12 +16,12 @@
   <parent>
     <artifactId>hadoop-yarn</artifactId>
     <groupId>org.apache.hadoop</groupId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn-site</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <name>hadoop-yarn-site</name>
 
   <properties>
diff --git a/hadoop-mapreduce-project/hadoop-yarn/pom.xml b/hadoop-mapreduce-project/hadoop-yarn/pom.xml
index f424050..2574659 100644
--- a/hadoop-mapreduce-project/hadoop-yarn/pom.xml
+++ b/hadoop-mapreduce-project/hadoop-yarn/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-yarn</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>pom</packaging>
   <name>hadoop-yarn</name>
 
diff --git a/hadoop-mapreduce-project/ivy/hadoop-mapred-instrumented-template.xml b/hadoop-mapreduce-project/ivy/hadoop-mapred-instrumented-template.xml
index 1bc4a54..8394e07 100644
--- a/hadoop-mapreduce-project/ivy/hadoop-mapred-instrumented-template.xml
+++ b/hadoop-mapreduce-project/ivy/hadoop-mapred-instrumented-template.xml
@@ -28,7 +28,7 @@
     <dependency>
       <groupId>org.apache.hadoop</groupId>
       <artifactId>hadoop-common</artifactId>
-      <version>2.0.0-alpha</version>
+      <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     </dependency>
   </dependencies>
 </project>
diff --git a/hadoop-mapreduce-project/ivy/hadoop-mapred-template.xml b/hadoop-mapreduce-project/ivy/hadoop-mapred-template.xml
index ba85f7c..9b9a08f 100644
--- a/hadoop-mapreduce-project/ivy/hadoop-mapred-template.xml
+++ b/hadoop-mapreduce-project/ivy/hadoop-mapred-template.xml
@@ -28,7 +28,7 @@
     <dependency>
       <groupId>org.apache.hadoop</groupId>
       <artifactId>hadoop-common</artifactId>
-      <version>2.0.0-alpha</version>
+      <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     </dependency>
   </dependencies>
 </project>
diff --git a/hadoop-mapreduce-project/ivy/libraries.properties b/hadoop-mapreduce-project/ivy/libraries.properties
index b33d367..642add9 100644
--- a/hadoop-mapreduce-project/ivy/libraries.properties
+++ b/hadoop-mapreduce-project/ivy/libraries.properties
@@ -41,8 +41,8 @@ ftplet-api.version=1.0.0
 ftpserver-core.version=1.0.0
 ftpserver-deprecated.version=1.0.0-M2
 
-hadoop-common.version=2.0.0-alpha
-hadoop-hdfs.version=2.0.0-alpha
+hadoop-common.version=2.0.0-cdh4.0.0-SNAPSHOT
+hadoop-hdfs.version=2.0.0-cdh4.0.0-SNAPSHOT
 
 hsqldb.version=1.8.0.10
 
@@ -82,5 +82,5 @@ xmlenc.version=0.52
 xerces.version=1.4.4
 
 jackson.version=1.8.8
-yarn.version=2.0.0-alpha
-hadoop-mapreduce.version=2.0.0-alpha
+yarn.version=2.0.0-cdh4.0.0-SNAPSHOT
+hadoop-mapreduce.version=2.0.0-cdh4.0.0-SNAPSHOT
diff --git a/hadoop-mapreduce-project/pom.xml b/hadoop-mapreduce-project/pom.xml
index 81cfc1c..e42adb9 100644
--- a/hadoop-mapreduce-project/pom.xml
+++ b/hadoop-mapreduce-project/pom.xml
@@ -18,12 +18,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-mapreduce</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>pom</packaging>
   <name>hadoop-mapreduce</name>
   <url>http://hadoop.apache.org/mapreduce/</url>
diff --git a/hadoop-mapreduce-project/src/test/aop/build/aop.xml b/hadoop-mapreduce-project/src/test/aop/build/aop.xml
index 2b286d1..168342c 100644
--- a/hadoop-mapreduce-project/src/test/aop/build/aop.xml
+++ b/hadoop-mapreduce-project/src/test/aop/build/aop.xml
@@ -21,7 +21,7 @@
   <property name="aspectversion" value="1.6.5"/>
   <!-- TODO this has to be changed synchronously with build.xml version prop.-->
   <!-- this workarounds of test-patch setting its own 'version' -->
-  <property name="project.version" value="2.0.0-alpha"/>
+  <property name="project.version" value="2.0.0-cdh4.0.0-SNAPSHOT"/>
 
   <!-- Properties common for all fault injections -->
   <property name="build-fi.dir" value="${basedir}/build-fi"/>
diff --git a/hadoop-minicluster/pom.xml b/hadoop-minicluster/pom.xml
index d8f3cda..7b59932 100644
--- a/hadoop-minicluster/pom.xml
+++ b/hadoop-minicluster/pom.xml
@@ -18,12 +18,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-minicluster</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <packaging>jar</packaging>
 
   <description>Apache Hadoop Mini-Cluster</description>
diff --git a/hadoop-project-dist/pom.xml b/hadoop-project-dist/pom.xml
index 647210a..c4366a0 100644
--- a/hadoop-project-dist/pom.xml
+++ b/hadoop-project-dist/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-project-dist</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Project Dist POM</description>
   <name>Apache Hadoop Project Dist POM</name>
   <packaging>pom</packaging>
diff --git a/hadoop-project/pom.xml b/hadoop-project/pom.xml
index 512076d..18d5c34 100644
--- a/hadoop-project/pom.xml
+++ b/hadoop-project/pom.xml
@@ -17,11 +17,11 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-main</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-project</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Project POM</description>
   <name>Apache Hadoop Project POM</name>
   <packaging>pom</packaging>
@@ -609,7 +609,7 @@
       <dependency>
         <groupId>org.apache.zookeeper</groupId>
         <artifactId>zookeeper</artifactId>
-        <version>3.4.2</version>
+        <version>${cdh.zookeeper.version}</version>
         <exclusions>
           <exclusion>
             <!-- otherwise seems to drag in junit 3.8.1 via jline -->
@@ -627,6 +627,13 @@
         </exclusions>
       </dependency>
       <dependency>
+        <groupId>org.apache.zookeeper</groupId>
+        <artifactId>zookeeper</artifactId>
+        <version>${cdh.zookeeper.version}</version>
+        <type>test-jar</type>
+        <scope>test</scope>
+      </dependency>
+      <dependency>
         <groupId>org.apache.bookkeeper</groupId>
         <artifactId>bookkeeper-server</artifactId>
         <version>4.0.0</version>
diff --git a/hadoop-tools/hadoop-archives/pom.xml b/hadoop-tools/hadoop-archives/pom.xml
index 8342908..fca7c3d 100644
--- a/hadoop-tools/hadoop-archives/pom.xml
+++ b/hadoop-tools/hadoop-archives/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-archives</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Archives</description>
   <name>Apache Hadoop Archives</name>
   <packaging>jar</packaging>
diff --git a/hadoop-tools/hadoop-distcp/pom.xml b/hadoop-tools/hadoop-distcp/pom.xml
index 74dd934..ef8c4dd 100644
--- a/hadoop-tools/hadoop-distcp/pom.xml
+++ b/hadoop-tools/hadoop-distcp/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-distcp</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Distributed Copy</description>
   <name>Apache Hadoop Distributed Copy</name>
   <packaging>jar</packaging>
diff --git a/hadoop-tools/hadoop-extras/pom.xml b/hadoop-tools/hadoop-extras/pom.xml
index a6718c0..f17fa95 100644
--- a/hadoop-tools/hadoop-extras/pom.xml
+++ b/hadoop-tools/hadoop-extras/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-extras</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Extras</description>
   <name>Apache Hadoop Extras</name>
   <packaging>jar</packaging>
diff --git a/hadoop-tools/hadoop-rumen/pom.xml b/hadoop-tools/hadoop-rumen/pom.xml
index f65a73b..0474e99 100644
--- a/hadoop-tools/hadoop-rumen/pom.xml
+++ b/hadoop-tools/hadoop-rumen/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-rumen</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Rumen</description>
   <name>Apache Hadoop Rumen</name>
   <packaging>jar</packaging>
@@ -91,16 +91,6 @@
   <build>
     <plugins>
       <plugin>
-        <groupId>org.codehaus.mojo</groupId>
-        <artifactId>findbugs-maven-plugin</artifactId>
-         <configuration>
-          <findbugsXmlOutput>true</findbugsXmlOutput>
-          <xmlOutput>true</xmlOutput>
-          <excludeFilterFile>${basedir}/dev-support/findbugs-exclude.xml</excludeFilterFile>
-          <effort>Max</effort>
-        </configuration>
-      </plugin>
-      <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-antrun-plugin</artifactId>
         <executions>
diff --git a/hadoop-tools/hadoop-streaming/pom.xml b/hadoop-tools/hadoop-streaming/pom.xml
index 300604f..02b5a93 100644
--- a/hadoop-tools/hadoop-streaming/pom.xml
+++ b/hadoop-tools/hadoop-streaming/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-streaming</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop MapReduce Streaming</description>
   <name>Apache Hadoop MapReduce Streaming</name>
   <packaging>jar</packaging>
@@ -96,16 +96,6 @@
 
   <build>
     <plugins>
-       <plugin>
-        <groupId>org.codehaus.mojo</groupId>
-        <artifactId>findbugs-maven-plugin</artifactId>
-         <configuration>
-          <findbugsXmlOutput>true</findbugsXmlOutput>
-          <xmlOutput>true</xmlOutput>
-          <excludeFilterFile>${basedir}/dev-support/findbugs-exclude.xml</excludeFilterFile>
-          <effort>Max</effort>
-        </configuration>
-      </plugin>
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-antrun-plugin</artifactId>
diff --git a/hadoop-tools/hadoop-tools-dist/pom.xml b/hadoop-tools/hadoop-tools-dist/pom.xml
index 6b58886..107eb28 100644
--- a/hadoop-tools/hadoop-tools-dist/pom.xml
+++ b/hadoop-tools/hadoop-tools-dist/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project-dist</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../../hadoop-project-dist</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-tools-dist</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Tools Dist</description>
   <name>Apache Hadoop Tools Dist</name>
   <packaging>jar</packaging>
diff --git a/hadoop-tools/pom.xml b/hadoop-tools/pom.xml
index 3bc7990..135132a 100644
--- a/hadoop-tools/pom.xml
+++ b/hadoop-tools/pom.xml
@@ -17,12 +17,12 @@
   <parent>
     <groupId>org.apache.hadoop</groupId>
     <artifactId>hadoop-project</artifactId>
-    <version>2.0.0-alpha</version>
+    <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
     <relativePath>../hadoop-project</relativePath>
   </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-tools</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Tools</description>
   <name>Apache Hadoop Tools</name>
   <packaging>pom</packaging>
diff --git a/pom.xml b/pom.xml
index 9b35e97..e12c5d3 100644
--- a/pom.xml
+++ b/pom.xml
@@ -14,24 +14,19 @@
 -->
 <project>
   <modelVersion>4.0.0</modelVersion>
+  <parent>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>cdh-root</artifactId>
+    <version>4.0.0-SNAPSHOT</version>
+  </parent>
   <groupId>org.apache.hadoop</groupId>
   <artifactId>hadoop-main</artifactId>
-  <version>2.0.0-alpha</version>
+  <version>2.0.0-cdh4.0.0-SNAPSHOT</version>
   <description>Apache Hadoop Main</description>
   <name>Apache Hadoop Main</name>
   <packaging>pom</packaging>
 
   <distributionManagement>
-    <repository>
-      <id>apache.staging.https</id>
-      <name>Apache Release Distribution Repository</name>
-      <url>https://repository.apache.org/service/local/staging/deploy/maven2</url>
-    </repository>
-    <snapshotRepository>
-      <id>apache.snapshots.https</id>
-      <name>${distMgmtSnapshotsName}</name>
-      <url>${distMgmtSnapshotsUrl}</url>
-    </snapshotRepository>
     <site>
       <id>apache.website</id>
       <url>scpexe://people.apache.org/www/hadoop.apache.org/docs/r${project.version}</url>
@@ -40,6 +35,26 @@
 
   <repositories>
     <repository>
+      <id>cdh.repo</id>
+      <url>https://repository.cloudera.com/artifactory/cloudera-repos</url>
+      <name>Cloudera Repositories</name>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+    <repository>
+      <id>cdh.snapshots.repo</id>
+      <url>https://repository.cloudera.com/artifactory/libs-snapshot-local</url>
+      <name>Cloudera Snapshots Repository</name>
+      <snapshots>
+        <enabled>true</enabled>
+      </snapshots>
+      <releases>
+        <enabled>false</enabled>
+      </releases>
+    </repository>
+
+    <repository>
       <id>apache.snapshots.https</id>
       <name>${distMgmtSnapshotsName}</name>
       <url>${distMgmtSnapshotsUrl}</url>
-- 
1.7.0.4

